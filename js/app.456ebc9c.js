(function(){"use strict";var t={9057:function(t,e,a){var i=a(9963),s=a(6252);function n(t,e,a,i,n,r){const o=(0,s.up)("Rhythm");return(0,s.wg)(),(0,s.j4)(o)}var r=a(3577),o="data:image/png;base64,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",l=a.p+"img/logo_small.4398bec1.png";const u={class:"w3-row"},h={id:"showOptions",class:"w3-col m2 s2"},c={id:"logoSection",class:"w3-col l6 m4 s2"},d={key:0,alt:"minLogo",src:o,style:{"max-width":"75px"}},m={key:1,alt:"smallLogo",src:l,style:{"max-width":"200px"}},p={id:"generate",class:"w3-col m2 s2"},y={class:"w3-row"},g={id:"optPanelSection",class:"w3-sidebar w3-card-2 w3-bar-block w3-animate-left"},D={id:"scoreSection"};function w(t,e,a,n,o,l){const w=(0,s.up)("RhythmSelection"),b=(0,s.up)("Score");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",u,[(0,s._)("div",h,[(0,s._)("button",{id:"showOptionsBtn",class:"w3-btn w3-round w3-white w3-border w3-border-teal",onClick:e[0]||(e[0]=(...t)=>l.displayOptions&&l.displayOptions(...t))},(0,r.zw)(o.optBtnTxt),1)]),(0,s._)("div",c,[o.minLogo?((0,s.wg)(),(0,s.iD)("img",d)):((0,s.wg)(),(0,s.iD)("img",m))]),(0,s._)("div",p,[(0,s._)("button",{id:"generateBtn",class:"w3-btn w3-round w3-teal",onClick:e[1]||(e[1]=t=>o.newSequence=!0)}," Générer ")])]),(0,s._)("div",y,[(0,s.wy)((0,s._)("div",g,[(0,s.Wm)(w,{rhythmData:o.rhythmData,onRhythmdatadto:e[2]||(e[2]=t=>o.rhythmData=t)},null,8,["rhythmData"])],512),[[i.F8,o.optVisible]]),(0,s._)("div",D,[(0,s.Wm)(b,{rhythmData:o.rhythmData,newSequence:o.newSequence,windowDims:o.windowDims,onSequenceGenerated:e[3]||(e[3]=t=>o.newSequence=!1)},null,8,["rhythmData","newSequence","windowDims"])])])],64)}const b={id:"displaySection"};function f(t,e,a,i,n,r){return(0,s.wg)(),(0,s.iD)("div",b)}var R=a(5266),v=(a(7658),{simpleValues:[1,2,4,8,16,32,64],dottedValues:[.6666666666666666,1.3333333333333333,2.6666666666666665,5.333333333333333,10.666666666666666,21.333333333333332,42.666666666666664],getConfiguredStave(t,e,a,i,s,n){var r=new t.Stave(a,0,i);return n&&r.addTimeSignature(e.toString()),r.options.right_bar=!1,r.options.left_bar=!1,r.options.line_config.forEach(((t,e)=>{t.visible=2===e})),r},getFormattedNotes(t,e,a){let i,s=[],n=[],r=[],o=[];return e.cellsList.forEach(((l,u)=>{let h,c;r=[],l.values.forEach((e=>{c=e.duration.toString(),h=new t.StaveNote({clef:"treble",keys:[e.key],duration:c}),c.includes("d")&&R.oT.buildAndAttach([h],{all:!0}),r.push(h)})),i=this.concatenateRests(r,t,l.isTuplet,e.signature,a.ternary),l.isTuplet&&(l.isTuplet=i.options.isTuplet),r=i.cellNotes;let d=this.getElemsToBeam(r);d.forEach((e=>{s.push(new t.Beam(e))})),0===u?o.push(r):o=o.concat(r),l.isTuplet&&n.push(new t.Tuplet(r,{num_notes:l.tupletNbNotes}))})),o=o.flat(),{tuplets:n,allNotes:o,beams:s}},getElemsToBeam(t){let e=[],a=[];return t.forEach(((i,s)=>{let n=!(!(t[s-1]&&t[s+1]&&t[s-1].intrinsicTicks<4096&&!t[s-1].isRest()&&t[s+1].intrinsicTicks<4096)||t[s-1].isRest());i.intrinsicTicks<4096&&(!i.isRest()||n)?a.push(i):(a.length>1&&e.push(a),a=[])})),a.length>1&&e.push(a),e},concatenateRests(t,e,a,i,s){let n=0,r=[],o={isTuplet:a,numNotes:0};while(t[n]){let o=0;if(t[n]&&t[n].isRest()){r=[];while(t[n]&&t[n].isRest())r.push(n),o+=t[n].intrinsicTicks,n++;if(r.length>1){let n=this.ticksToDuration(o);o=n.value;let l=[];n.referenced?l.push(o):(l=this.breakDownDuration(o),console.log("restDurationArray: ",l)),l.forEach(((o,u)=>{this.dottedValues.includes(o)&&(console.error("in dottedValues"),o+="d"),o+="r",t[r[u]].duration=o;let h=new e.StaveNote({clef:"treble",keys:["B/4"],duration:o});!a&&n.dotted&&(console.error("adding dot"),console.log(h.duration),R.oT.buildAndAttach([h],{all:!0}),console.log("newNote.duration: ",h.duration));let c=u===l.length-1?r.length-u:0;if(!n.referenced){let e=t.map((t=>({duration:t.intrinsicTicks,isRest:t.isRest()})));console.log("vfNotesArray durations before splice: "),e.forEach((t=>{console.log(t)}))}t.splice(r[u],c,h),console.log("vfNotesArray: ",t);let d,m=[],p=!1,y=0,g=s?3*this.durationToTicks(i.beatValue):this.durationToTicks(i.beatValue);a&&(g*=2/3);let D=0;while(!p&&D<t.length)m.push(t[D]),d=t[D].isDotted()?3*t[D].intrinsicTicks/2:t[D].intrinsicTicks,y+=d,console.log("barDuration: ",y," / ",g),y===g&&(p=!0),D++;if(y<g){let t=this.ticksToDuration(g-y).value;console.error("adding note of duration ",t),m.push(new e.StaveNote({clef:"treble",keys:["B/4"],duration:t.toString()}))}if(t=m,!n.referenced){let e=t.map((t=>{let e=t.isDotted()?3*t.intrinsicTicks/2:t.intrinsicTicks;return{duration:e,isRest:t.isRest()}}));console.log("vfNotesArray durations after splice: "),e.forEach((t=>{console.log(t)}))}}))}}else n++}let l=!0;return t.forEach((t=>{t.isRest()||(l=!1)})),l&&s&&1===t.length&&!t[0].isDotted()&&(console.log(t[0]),t[0].addDot(0)),o.isTuplet=a&&!l,{cellNotes:t,options:o}},sumDurations(t){let e;return e=t.reduce((function(t,e){return t+e})),e},getTotalDuration(t){let e=0;return t.forEach((t=>{e+=t.intrinsicTicks})),e},ticksToDuration(t){let e,a=!0,i=!1,s=1/t*16384;return this.simpleValues.includes(s)?s*=1:this.dottedValues.includes(s)?(s=Math.round(1.5*s*100)/100,i=!0):(console.error(s," is not a referenced value"),a=!1),e={value:s,referenced:a,dotted:i},e},durationToTicks(t){let e=1/(t/16384);return e},breakDownDuration(t){let e=[],a=this.durationToTicks(t);console.log("ticks for duration ",t,": ",a);let i=this.simpleValues.map((t=>this.durationToTicks(t))),s=this.getClosestNumberInArray(a,i);e.push(this.ticksToDuration(s).value);let n=a-s;return e.push(this.ticksToDuration(n).value),console.log("closestNb: ",s," / lastingValue: ",n),e},getClosestNumberInArray(t,e){return e.filter((e=>e<=t)).reduce(((e,a)=>Math.abs(a-t)<Math.abs(e-t)?a:e))}});class k{constructor(t,e){this.numBeats=t,this.beatValue=e}toString(){return this.numBeats+"/"+this.beatValue}}class S{constructor(t,e,a,i){this.minimalValue=t,this.signature=e,this.options=a,this.barsList=i}}class A{constructor(t,e,a){this.acceptedValues=t,this.signature=e,this.cellsList=a}}class B{constructor(){this.values=[],this.isTuplet=!1,this.tupletNbNotes=3}}class V{constructor(t,e){this.key=t,this.duration=e}}var E={tmpValues:[],generateCell(t,e,a){let i,s=new B,n=e.beatValue;a.ternary?(i=1.5,n/=2):i=1;let r=a.tuplets&&Math.random()<=a.tupletsRatio;if(s.values=[],r){s.isTuplet=!0,s.tupletNbNotes=a.ternary?2:3;let t=a.ternary?parseInt(e.beatValue):2*parseInt(e.beatValue);for(let e=0;e<s.tupletNbNotes;e++)s.values.push(new V("B/4",t))}else{let e;this.tmpValues=[...t.keys()];while(!this.isCellComplete(s.values,n,i)){e=this.getNewValue(this.tmpValues);let t=new V("B/4",e);s.values.push(t)}this.tmpValues=[...t.keys()]}let o=s.values.filter((t=>void 0!=t.duration));return s.values=o,s},getNewValue(){let t=this.tmpValues[Math.trunc(Math.random()*this.tmpValues.length)];return t},isCellComplete(t,e,a){let i=!1,s=0;return t.forEach(((t,n)=>{s+=1/t.duration*e,(s>=a||n>12)&&(i=!0)})),this.tmpValues=this.tmpValues.filter((t=>1/t*e<=a-s)),i}},O={generateBar(t,e,a,i){let s,n=.2,r=new A(t,a),o=[],l=i.ternary?a.numBeats/3:a.numBeats,u=i.ternary?l-3:l-1;for(let h=0;h<l;h++){if(n&&Math.random()<=n&&h<u){i.isLargeCell=!0;const t={numBeats:a.numBeats,beatValue:a.beatValue/2};s=E.generateCell(e,t,i),h++}else i.isLargeCell=!1,s=E.generateCell(t,a,i);s.values.forEach((e=>{e.duration=t.get(e.duration),i.rests&&Math.random()<=i.restsRatio&&(e.duration=e.duration+"r")})),o.push(s)}return r.cellsList=o,r}},T={simpleValues:[1,2,4,8,16,32,64],generateSequence(t,e,a,i){console.log("GENERATING SEQUENCE__");let s,n=new S(t,e,a,i),r=[],o=this.getAcceptedValues(t,e),l=new Map([...o].filter((([t])=>t<=2*e.beatValue)));i.dots&&(o=this.generateDottedDurations(o),l=this.generateDottedDurations(l));for(let u=0;u<a;u++)s=O.generateBar(o,l,e,i),r.push(s);return n.barsList=r,n},getAcceptedValues(t,e){let a=new Map;return this.simpleValues.forEach((i=>{i<=t&&i>=e.beatValue&&a.set(i,i.toString())})),a},generateDottedDurations(t){let e=Math.max(...t.values());return t.forEach(((e,a)=>{0!==a&&t.set(e*(2/3),e+"d")})),t.delete(e*(2/3)),t.delete(NaN),t}};const{Renderer:C}=R.sj.Flow;var N={name:"Score",props:{rhythmData:Object,newSequence:Boolean,windowDims:Object},data(){return{barWidth:400,nbBarsPerLine:1,sizeReduction:10,sequence:null,signature:null}},watch:{newSequence(){this.generateSequence(),this.display(this.sequence)},windowDims(){this.sequence&&(this.clearBox("displaySection"),this.display(this.sequence))}},methods:{generateSequence(){this.signature=new k,this.signature.numBeats=this.rhythmData.signature.numBeats,this.signature.beatValue=this.rhythmData.signature.beatValue;let t=this.rhythmData.options.minimalValue;this.sequence=T.generateSequence(t,this.signature,this.rhythmData.numBars,this.rhythmData.options)},display(t){this.clearBox("displaySection"),this.adaptBarWidth(this.windowDims,this.sizeReduction),this.setDisplaySection();const e=document.getElementsByClassName("displayLine");let a,i,s,n,r,o=0;t.barsList.forEach(((t,l)=>{0===l?n=0:n+=this.barWidth,a=e[o],l%this.nbBarsPerLine===0&&(n=0,r=!0,i=new C(a,C.Backends.SVG),i.resize(this.windowDims.width,100),s=i.getContext(),o++),i.element=e[o];var u=v.getConfiguredStave(R.sj.Flow,this.signature,n,this.barWidth,l,r);r=!1;let h=v.getFormattedNotes(R.sj.Flow,t,this.rhythmData.options);u.setContext(s).draw(),R.sj.Flow.Formatter.FormatAndDraw(s,u,h.allNotes),h.beams.forEach((t=>{t.setContext(s).draw()})),h.tuplets.length>0&&h.tuplets.forEach((t=>{t.setContext(s).draw()}))})),this.$emit("sequenceGenerated",!0)},setDisplaySection(){let t=document.getElementById("displaySection"),e=this.rhythmData.numBars/this.nbBarsPerLine;for(let a=0;a<e;a++){let e=document.createElement("div");e.className="displayLine",e.style="align-content:start",t.appendChild(e)}},adaptBarWidth(t,e){let a=this.rhythmData.options,i=this.rhythmData.signature,s=Math.sqrt(1/i.beatValue*i.numBeats*(a.minimalValue/4)/4),n=t.width<600?1:t.width<1200?2:4,r=t.width-t.width*e/100;this.barWidth=r/n*s,this.nbBarsPerLine=Math.trunc(r/this.barWidth),this.nbBarsPerLine<1&&(this.nbBarsPerLine=1)},clearBox(t){document.getElementById(t).innerHTML=""}}},L=a(3744);const F=(0,L.Z)(N,[["render",f],["__scopeId","data-v-73dbe34e"]]);var M=F;const H=t=>((0,s.dD)("data-v-1d3d4f80"),t=t(),(0,s.Cn)(),t),x={id:"timeSignature",class:"option-element"},I=H((()=>(0,s._)("label",{for:"numBeats",style:{"font-weight":"bold",display:"block","margin-top":"5px"}},"Métrique : ",-1))),W=H((()=>(0,s._)("label",{for:"beatValue",style:{"font-weight":"bold"}}," / ",-1))),j=["value"],U={class:"option-element"},Z=H((()=>(0,s._)("label",{for:"ternary"},"ternaire",-1))),q={class:"option-element"},G={id:"numBars"},J=H((()=>(0,s._)("label",{for:"numBars"},"mesures",-1))),P={class:"option-element"},z=H((()=>(0,s._)("label",{style:{"font-weight":"bold",display:"block"},for:"minimalValue"}," Valeur minimale : ",-1))),Q=["value"],Y=H((()=>(0,s._)("hr",null,null,-1))),K={class:"option-element"},X=H((()=>(0,s._)("label",{for:"dots"},"notes pointées",-1))),_={class:"option-element"},$={for:"tuplets",style:{"margin-right":"5px"}},tt={for:"tupletsRatio"},et={class:"option-element"},at={class:"slider-wrapper"},it={class:"option-element"},st=H((()=>(0,s._)("label",{for:"rests",style:{"margin-right":"5px"}}," Silences ",-1))),nt={for:"restsRatio"},rt={class:"option-element"},ot={class:"slider-wrapper"};function lt(t,e,a,n,o,l){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",x,[I,(0,s.wy)((0,s._)("input",{type:"number",id:"numBeats",min:"1",max:"16","onUpdate:modelValue":e[0]||(e[0]=t=>o.rhythmDataDTO.signature.numBeats=t),onChange:e[1]||(e[1]=(...t)=>l.changeSignature&&l.changeSignature(...t))},null,544),[[i.nr,o.rhythmDataDTO.signature.numBeats]]),W,(0,s.wy)((0,s._)("select",{id:"beatValue","onUpdate:modelValue":e[2]||(e[2]=t=>o.rhythmDataDTO.signature.beatValue=t),onChange:e[3]||(e[3]=(...t)=>l.changeSignature&&l.changeSignature(...t)),style:{"margin-left":"5px"}},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.beatValues,(t=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,r.zw)(t),9,j)))),128))],544),[[i.bM,o.rhythmDataDTO.signature.beatValue]])]),(0,s.wy)((0,s._)("div",U,[(0,s.wy)((0,s._)("input",{id:"ternary",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=t=>o.rhythmDataDTO.options.ternary=t),onChange:e[5]||(e[5]=(...t)=>l.changeSignature&&l.changeSignature(...t))},null,544),[[i.e8,o.rhythmDataDTO.options.ternary]]),Z],512),[[i.F8,o.ternaryByDefault]]),(0,s._)("div",q,[(0,s._)("div",G,[(0,s.wy)((0,s._)("input",{id:"numBars","onUpdate:modelValue":e[6]||(e[6]=t=>o.rhythmDataDTO.numBars=t),onChange:e[7]||(e[7]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t)),type:"number",min:"1",max:"16"},null,544),[[i.nr,o.rhythmDataDTO.numBars]]),J])]),(0,s._)("div",P,[z,(0,s.wy)((0,s._)("select",{id:"minimalValue","onUpdate:modelValue":e[8]||(e[8]=t=>o.rhythmDataDTO.options.minimalValue=t),onChange:e[9]||(e[9]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.minimalValues,(t=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,r.zw)(o.durationsDict[t]),9,Q)))),128))],544),[[i.bM,o.rhythmDataDTO.options.minimalValue]])]),Y,(0,s._)("div",K,[(0,s.wy)((0,s._)("input",{id:"dots",type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=t=>o.rhythmDataDTO.options.dots=t)},null,512),[[i.e8,o.rhythmDataDTO.options.dots]]),X]),(0,s._)("div",_,[(0,s.wy)((0,s._)("input",{id:"tuplets",type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=t=>o.rhythmDataDTO.options.tuplets=t),onChange:e[12]||(e[12]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t))},null,544),[[i.e8,o.rhythmDataDTO.options.tuplets]]),(0,s._)("label",$,(0,r.zw)(l.getTupletsStr),1),(0,s._)("label",tt,(0,r.zw)(l.getTupletsPercentage),1)]),(0,s._)("div",et,[(0,s._)("div",at,[(0,s.wy)((0,s._)("input",{id:"tupletsRatio",type:"range",class:"form-range","onUpdate:modelValue":e[13]||(e[13]=t=>o.rhythmDataDTO.options.tupletsRatio=t),onChange:e[14]||(e[14]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t)),step:"0.05",min:"0",max:"1"},null,544),[[i.nr,o.rhythmDataDTO.options.tupletsRatio]])])]),(0,s._)("div",it,[(0,s.wy)((0,s._)("input",{id:"rests",type:"checkbox","onUpdate:modelValue":e[15]||(e[15]=t=>o.rhythmDataDTO.options.rests=t),onChange:e[16]||(e[16]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t))},null,544),[[i.e8,o.rhythmDataDTO.options.rests]]),st,(0,s._)("label",nt,(0,r.zw)(l.getRestsPercentage),1)]),(0,s._)("div",rt,[(0,s._)("div",ot,[(0,s.wy)((0,s._)("input",{id:"restsRatio",type:"range",class:"form-range","onUpdate:modelValue":e[17]||(e[17]=t=>o.rhythmDataDTO.options.restsRatio=t),onChange:e[18]||(e[18]=(...t)=>l.updateRhytmData&&l.updateRhytmData(...t)),step:"0.05",min:"0",max:"1"},null,544),[[i.nr,o.rhythmDataDTO.options.restsRatio]])])])],64)}var ut={name:"RhythmSelection",emits:["rhythmdatadto"],props:{rhythmData:Object},data(){return{rhythmDataDTO:this.rhythmData,beatValues:["2","4","8","16"],minimalValues:["4","8","16","32"],durationsDict:{1:"ronde",2:"blanche",4:"noire",8:"croche",16:"double",32:"triple"},ternaryByDefault:!1}},created(){this.setDefaultPulse()},methods:{updateRhytmData(){this.$emit("rhythmdatadto",this.rhythmDataDTO)},changeSignature(){this.adaptMinimalValue(),this.setDefaultPulse(),this.updateRhytmData()},adaptMinimalValue(){let t=4*this.rhythmDataDTO.signature.beatValue;t=this.rhythmDataDTO.options.ternary?t/2:t,this.rhythmDataDTO.options.minimalValue=t<=32?t:32},setDefaultPulse(){this.ternaryByDefault=this.isSignatureTernaryByDefault(),this.ternaryByDefault||(this.rhythmDataDTO.options.ternary=!1)},isSignatureTernaryByDefault(){return this.rhythmDataDTO.signature.numBeats%3==0&&8==this.rhythmDataDTO.signature.beatValue}},computed:{getTupletsPercentage(){return Math.trunc(100*this.rhythmDataDTO.options.tupletsRatio)+" %"},getTupletsStr(){return this.rhythmDataDTO.options.ternary?"duolets":"triolets"},getRestsPercentage(){return Math.trunc(100*this.rhythmDataDTO.options.restsRatio)+" %"}}};const ht=(0,L.Z)(ut,[["render",lt],["__scopeId","data-v-1d3d4f80"]]);var ct=ht,dt={name:"Rhythm",components:{RhythmSelection:ct,Score:M},props:{tupletsTest:Boolean},data(){return{rhythmData:{signature:{numBeats:4,beatValue:4},options:{dots:!0,tuplets:!0,tupletsRatio:"0.1",minimalValue:16,ternary:!1,rests:!0,restsRatio:"0.1"},numBars:"16"},optVisible:!1,optBtnTxt:"Options",newSequence:!1,windowDims:null,minLogo:!1}},created(){this.getWindowDimsOnResize(),this.closeOptPanelOnClickOutside()},methods:{getWindowDimsOnResize(){this.windowDims=this.getWindowDims(),this.isMinLogo(),window.addEventListener("resize",(()=>{this.windowDims=this.getWindowDims(),this.isMinLogo()}))},closeOptPanelOnClickOutside(){window.addEventListener("click",(t=>{if(this.optVisible&&!["showOptionsBtn","generateBtn"].includes(t.target.id)){const e=document.getElementById("optPanelSection");e.contains(t.target)||this.displayOptions()}}))},displayOptions(){this.optVisible=!this.optVisible,this.optBtnTxt=this.optVisible?"Masquer":"Options"},getWindowDims(){const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:t,height:e}},isMinLogo(){this.minLogo=this.windowDims.width<=600}}};const mt=(0,L.Z)(dt,[["render",w],["__scopeId","data-v-45bccf22"]]);var pt=mt,yt={name:"App",components:{Rhythm:pt}};const gt=(0,L.Z)(yt,[["render",n]]);var Dt=gt;(0,i.ri)(Dt).mount("#app")}},e={};function a(i){var s=e[i];if(void 0!==s)return s.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(e,i,s,n){if(!i){var r=1/0;for(h=0;h<t.length;h++){i=t[h][0],s=t[h][1],n=t[h][2];for(var o=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(t){return a.O[t](i[l])}))?i.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(h--,1);var u=s();void 0!==u&&(e=u)}}return e}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[i,s,n]}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/rhythm-generator-v2/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,n,r=i[0],o=i[1],l=i[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var h=l(a)}for(e&&e(i);u<r.length;u++)n=r[u],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(h)},i=self["webpackChunkrhythm_generator_v2"]=self["webpackChunkrhythm_generator_v2"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(9057)}));i=a.O(i)})();
//# sourceMappingURL=app.456ebc9c.js.map